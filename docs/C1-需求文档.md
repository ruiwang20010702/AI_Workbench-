---

# **AI 笔记 Web 应用 产品需求文档（PRD）**

---

## 1. **文档概述**
### 1.1 项目背景
基于硅基流动的 API，开发一款轻量级、智能化的 **Web 端笔记应用**，帮助用户高效记录、管理和搜索笔记，同时通过 AI 辅助提升生产力。

### 1.2 目标用户
- **个人用户**：需要记录日常工作、学习和生活笔记的用户。

### 1.3 核心价值
- **极简编辑体验**：支持富文本和 Markdown，提供高效的斜杠命令和 AI 快捷操作。
- **智能辅助**：通过 AI 实现文本生成、改写、摘要、待办抽取、语义搜索等功能。

---

## 2. **功能需求**
### 2.1 核心功能
#### **1. 笔记管理**
- **新建/编辑笔记**：支持富文本和 Markdown 编辑，自动保存，支持斜杠命令（`/`）插入表格、代码块等。
- **笔记本与标签**：用户可创建和管理笔记本，为笔记添加标签（支持颜色标记）。
- **语义搜索**：基于 RAG（Retrieval-Augmented Generation）技术，支持自然语言搜索笔记内容。

#### **2. AI 辅助功能**
- **文本生成**：根据提示词生成内容（如续写、草稿）。
- **文本改写**：支持正式化、口语化、精简等风格改写。
- **摘要生成**：自动生成笔记摘要。
- **待办抽取**：从笔记文本中自动提取待办事项。
- **AI 模型切换**：用户可在 GPT-3.5 和 GPT-4 等模型间切换，显示成本提示。

#### **3. TodoList 功能**
- **自动抽取**：从笔记文本中提取待办事项（调用硅基流动 API）。
- **手动创建**：支持用户手动创建和管理待办事项（标题、描述、状态、截止日期）。
- **全局视图**：提供待办列表页面，支持按笔记本和标签过滤，显示待办事项的笔记链接。

#### **4. 用户账户**
- **注册/登录**：支持邮箱 + 密码和第三方登录（Google/GitHub）。
- **设置页**：提供主题切换（亮色/暗色）和快捷键自定义功能。

---

## 3. **技术需求**
### 3.1 前端技术栈
- **框架**：React 18 + TypeScript
- **UI 库**：Tailwind CSS + Headless UI
- **富文本编辑器**：Tiptap（ProseMirror 生态）
- **状态管理**：Zustand
- **API 客户端**：Axios + React Query
- **性能监控**：Sentry

### 3.2 后端技术栈
- **框架**：Node.js + Express
- **数据库**：PostgreSQL（带 pgvector 扩展）
- **缓存**：Redis
- **日志与监控**：Prometheus + Grafana + Datadog

### 3.3 API 设计
#### **笔记管理**
- `GET /v1/notes`：获取笔记列表（支持过滤和分页）。
- `POST /v1/notes`：创建新笔记。
- `GET /v1/notes/:id`：获取单篇笔记内容。
- `PATCH /v1/notes/:id`：更新笔记内容。
- `DELETE /v1/notes/:id`：删除笔记。

#### **TodoList 功能**
- `GET /v1/todos`：获取待办列表（支持过滤和分页）。
- `POST /v1/todos`：创建待办事项。
- `PATCH /v1/todos/:id`：更新待办事项。

#### **AI 功能**
- `POST /v1/ai/generate`：文本生成。
- `POST /v1/ai/rewrite`：文本改写。
- `POST /v1/ai/summarize`：生成摘要。
- `POST /v1/ai/extract-todos`：抽取待办事项。
- `POST /v1/ai/search`：语义搜索。

---

## 4. **数据模型**
### 4.1 用户表
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY,
  email CITEXT UNIQUE,
  password_hash TEXT,
  auth_provider TEXT,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

### 4.2 笔记表
```sql
CREATE TABLE notes (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  notebook_id UUID REFERENCES notebooks(id),
  title TEXT,
  content TEXT,
  tags TEXT[] DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

### 4.3 Todo 表
```sql
CREATE TABLE todos (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  note_id UUID REFERENCES notes(id) ON DELETE CASCADE,
  title TEXT NOT NULL,
  description TEXT,
  due_date DATE,
  status TEXT CHECK (status IN ('未开始', '进行中', '已完成')),
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

---

## 5. **非功能需求**
### 5.1 性能
- **前端加载时间**：首屏加载时间 ≤ 2 秒，API 响应时间 ≤ 500ms。

### 5.2 安全性
- **认证**：JWT + HTTPS 加密。
- **日志**：记录用户操作和 API 调用日志。

### 5.3 可扩展性
- **模块化设计**：前端组件和后端 API 模块化，便于后续功能扩展。
- **云原生架构**：支持容器化部署，未来可扩展至 Kubernetes。

---

## 6. **开发计划**
### 6.1 MVP 版本（2 周）
- 实现基础笔记管理功能（新建、编辑、删除）。
- 集成 AI 文本生成和改写功能。
### 6.2 迭代 1（2 周）
- 实现 TodoList 功能（自动抽取、手动创建、全局视图）。
- 实现语义搜索功能（RAG）。

---

## 7. **风险与缓解措施**
| 风险                  | 缓解措施                                   |
|-----------------------|------------------------------------------|
| AI 调用成本过高       | 实现配额管理和成本提示功能。             |
| 语义搜索性能瓶颈     | 使用 pgvector 索引优化向量搜索。         |

---
